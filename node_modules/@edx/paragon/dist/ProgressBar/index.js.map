{"version":3,"file":"index.js","names":["React","useCallback","useEffect","ProgressBarBase","PropTypes","classNames","Annotation","getOffsetStyles","placeInfoAtZero","ANNOTATION_CLASS","HINT_SWAP_PERCENT","PROGRESS_DEFAULT_VARIANT","THRESHOLD_DEFAULT_VARIANT","VARIANTS","ProgressBar","props","createElement","ProgressBarAnnotated","_ref","now","label","variant","threshold","thresholdLabel","thresholdVariant","progressHint","thresholdHint","_objectWithoutProperties","_excluded","progressInfoRef","useRef","thresholdInfoRef","thresholdPercent","isProgressHintAfter","isThresholdHintAfter","progressColor","includes","thresholdColor","direction","window","getComputedStyle","document","body","getPropertyValue","positionAnnotations","observer","ResizeObserver","progressInfoEl","current","observe","unobserve","getHint","text","className","style","ref","_extends","srOnly","arrowPlacement","propTypes","number","node","oneOf","string","defaultProps","undefined","Annotated"],"sources":["../../src/ProgressBar/index.jsx"],"sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport ProgressBarBase from 'react-bootstrap/ProgressBar';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport Annotation from '../Annotation';\nimport { getOffsetStyles, placeInfoAtZero } from './utils';\n\nexport const ANNOTATION_CLASS = 'pgn__annotation';\nconst HINT_SWAP_PERCENT = 50;\nconst PROGRESS_DEFAULT_VARIANT = 'warning';\nconst THRESHOLD_DEFAULT_VARIANT = 'dark';\nconst VARIANTS = [\n  'dark',\n  'warning',\n  'success',\n  'error',\n];\n\nfunction ProgressBar(props) {\n  return <ProgressBarBase {...props} />;\n}\n\nfunction ProgressBarAnnotated({\n  now,\n  label,\n  variant,\n  threshold,\n  thresholdLabel,\n  thresholdVariant,\n  progressHint,\n  thresholdHint,\n  ...props\n}) {\n  const progressInfoRef = React.useRef();\n  const thresholdInfoRef = React.useRef();\n  const thresholdPercent = (threshold || 0) - (now || 0);\n  const isProgressHintAfter = now < HINT_SWAP_PERCENT;\n  const isThresholdHintAfter = threshold < HINT_SWAP_PERCENT;\n  const progressColor = VARIANTS.includes(variant) ? variant : PROGRESS_DEFAULT_VARIANT;\n  const thresholdColor = VARIANTS.includes(thresholdVariant) ? thresholdVariant : THRESHOLD_DEFAULT_VARIANT;\n  const direction = window.getComputedStyle(document.body).getPropertyValue('direction');\n\n  const positionAnnotations = useCallback(() => {\n    placeInfoAtZero(progressInfoRef, direction, isProgressHintAfter, ANNOTATION_CLASS);\n    placeInfoAtZero(thresholdInfoRef, direction, isThresholdHintAfter, ANNOTATION_CLASS);\n  }, [direction, isProgressHintAfter, isThresholdHintAfter]);\n\n  useEffect(() => {\n    positionAnnotations();\n    const observer = new ResizeObserver(() => {\n      positionAnnotations();\n    });\n    const progressInfoEl = progressInfoRef.current;\n    observer.observe(progressInfoEl);\n    return () => progressInfoEl && observer.unobserve(progressInfoEl);\n  }, [positionAnnotations]);\n\n  const getHint = (text) => (\n    <span className=\"pgn__progress-hint\" data-testid=\"progress-hint\">\n      {text}\n    </span>\n  );\n\n  return (\n    <div className=\"pgn__progress-annotated\">\n      {!!label && (\n        <div\n          className=\"pgn__progress-info\"\n          style={getOffsetStyles(now, direction)}\n          ref={progressInfoRef}\n        >\n          {!isProgressHintAfter && getHint(progressHint)}\n          <Annotation variant={progressColor}>\n            {label}\n          </Annotation>\n          {isProgressHintAfter && getHint(progressHint)}\n        </div>\n      )}\n      <ProgressBarBase>\n        <ProgressBarBase\n          {...props}\n          now={now}\n          className={classNames(\n            `pgn__progress-bar--${progressColor}`,\n            thresholdPercent > 0 ? 'pgn__progress-tick--white' : 'pgn__progress-tick--black',\n          )}\n          srOnly\n        />\n        {!!threshold && (\n          <ProgressBarBase\n            now={thresholdPercent}\n            className={`pgn__progress-bar--${thresholdColor}`}\n            srOnly\n          />\n        )}\n      </ProgressBarBase>\n      {(!!threshold && !!thresholdLabel) && (\n        <div\n          className=\"pgn__progress-info\"\n          style={getOffsetStyles(threshold, direction)}\n          ref={thresholdInfoRef}\n        >\n          {!isThresholdHintAfter && getHint(thresholdHint)}\n          <Annotation\n            arrowPlacement=\"top\"\n            variant={thresholdColor}\n          >\n            {thresholdLabel}\n          </Annotation>\n          {isThresholdHintAfter && getHint(thresholdHint)}\n        </div>\n      )}\n    </div>\n  );\n}\n\nProgressBarAnnotated.propTypes = {\n  /** Current value of progress. */\n  now: PropTypes.number,\n  /** Show label that represents visual percentage. */\n  label: PropTypes.node,\n  /** The `ProgressBar` style variant to use. */\n  variant: PropTypes.oneOf(VARIANTS),\n  /** Specifies an additional `className` to add to the base element. */\n  className: PropTypes.string,\n  /** Threshold current value. */\n  threshold: PropTypes.number,\n  /** Specifies label for `threshold`. */\n  thresholdLabel: PropTypes.node,\n  /** Variant for threshold value. */\n  thresholdVariant: PropTypes.oneOf(VARIANTS),\n  /** Text near the progress annotation. */\n  progressHint: PropTypes.node,\n  /** Text near the threshold annotation. */\n  thresholdHint: PropTypes.node,\n};\n\nProgressBarAnnotated.defaultProps = {\n  now: undefined,\n  label: undefined,\n  variant: PROGRESS_DEFAULT_VARIANT,\n  className: undefined,\n  threshold: undefined,\n  thresholdLabel: undefined,\n  thresholdVariant: THRESHOLD_DEFAULT_VARIANT,\n  progressHint: undefined,\n  thresholdHint: undefined,\n};\n\nProgressBar.Annotated = ProgressBarAnnotated;\nexport default ProgressBar;\n"],"mappings":"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"}